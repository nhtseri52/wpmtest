<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Typing Master Pro - Nhtseri Admin</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --primary: #4a90e2; --bg: #f0f2f5; --border: #ddd; --success: #2ecc71; --error: #e74c3c; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: var(--bg); margin: 0; display: flex; justify-content: center; padding: 20px; }
        .main-wrapper { display: flex; gap: 20px; width: 100%; max-width: 1200px; }
        
        /* Sidebar */
        .sidebar { width: 300px; flex-shrink: 0; }
        .menu-group { background: white; border-radius: 8px; border: 1px solid var(--border); margin-bottom: 15px; overflow: hidden; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .menu-item { padding: 12px 15px; display: flex; align-items: center; cursor: pointer; color: #333; text-decoration: none; border-bottom: 1px solid #eee; transition: 0.2s; }
        .menu-item:hover { background: #f9f9f9; }
        .menu-item.active { background: var(--primary); color: white; }
        .menu-item i { width: 25px; margin-right: 10px; }

        /* Content */
        .content-card { flex-grow: 1; background: white; padding: 25px; border-radius: 8px; border: 1px solid var(--border); min-height: 550px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .word-box { background: #f8f9fa; padding: 20px; border-radius: 8px; font-size: 22px; line-height: 1.8; height: 100px; overflow: hidden; display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 20px; border: 1px solid #eee; }
        .word { color: #888; transition: 0.1s; }
        .word.current { background: #d1d8e0; border-radius: 4px; padding: 0 5px; color: #333; }
        .word.correct { color: var(--success); }
        .word.incorrect { color: var(--error); text-decoration: underline; }
        
        .input-line { display: flex; gap: 10px; }
        input[type="text"], input[type="password"], input[type="email"], textarea { padding: 12px; border: 1px solid var(--border); border-radius: 4px; width: 100%; box-sizing: border-box; }
        #typing-input, #custom-typing-input { font-size: 20px; }

        .btn { padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; background: var(--primary); color: white; font-weight: bold; white-space: nowrap; }
        .btn-green { background: var(--success); }
        .hidden { display: none !important; }

        /* Auth Tabs */
        .auth-tabs { display: flex; border-bottom: 1px solid #eee; margin-bottom: 15px; }
        .auth-tab { flex: 1; padding: 10px; text-align: center; cursor: pointer; background: #f4f4f4; }
        .auth-tab.active { background: white; font-weight: bold; border-top: 2px solid var(--primary); }

        /* Finger Guide */
        

[Image of touch typing finger positions]

        .finger-guide { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 15px; }
        .hand-card { border: 1px solid var(--border); padding: 15px; border-radius: 8px; background: #fffcf5; }
        
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 10px; border: 1px solid var(--border); text-align: center; }
    </style>
</head>
<body>

    <div class="main-wrapper">
        <div class="sidebar">
            <div id="guest-sidebar" class="menu-group">
                <div class="menu-item active" onclick="showModal('auth-modal')"><i class="fa-solid fa-sign-in"></i> Đăng nhập / Đăng ký</div>
            </div>

            <div id="user-sidebar" class="menu-group hidden">
                <div class="menu-item active" id="m1" onclick="switchTab('tab-1')"><i class="fa-solid fa-keyboard"></i> Tập đánh máy</div>
                <div class="menu-item" id="m2" onclick="switchTab('tab-2')"><i class="fa-solid fa-hand"></i> Hướng dẫn 10 ngón</div>
                <div class="menu-item" id="m3" onclick="switchTab('tab-3')"><i class="fa-solid fa-trophy"></i> Top 100</div>
                <div class="menu-item" id="m4" onclick="switchTab('tab-4')"><i class="fa-solid fa-share-nodes"></i> Chia sẻ văn bản</div>
                <div class="menu-item" id="m5" onclick="switchTab('tab-5')"><i class="fa-solid fa-sliders"></i> Văn bản tùy chỉnh</div>
            </div>

            <div id="profile-sidebar" class="menu-group hidden">
                <div class="menu-item" id="mp" onclick="switchTab('tab-profile')"><i class="fa-solid fa-id-card"></i> Hồ sơ</div>
                <div class="menu-item" style="color: var(--error);" onclick="logout()"><i class="fa-solid fa-power-off"></i> Đăng xuất</div>
            </div>
        </div>

        <div class="content-card">
            <div id="tab-1" class="tab-content">
                <h2 id="typing-title">Tập đánh máy (Top 200 từ)</h2>
                <div id="word-display" class="word-box"></div>
                <div class="input-line">
                    <input type="text" id="typing-input" placeholder="Gõ để bắt đầu...">
                    <div id="timer" style="background: var(--primary); color: white; padding: 10px; border-radius: 4px; font-weight: bold;">30</div>
                    <button class="btn" onclick="resetTyping(true)">Làm lại</button>
                </div>
            </div>

            <div id="tab-2" class="tab-content hidden">
                <h2>Hướng dẫn gõ 10 ngón</h2>
                <div class="finger-guide">
                    <div class="hand-card"><b>Tay Trái:</b><br>Ngón út: A Q Z 1<br>Áp út: S W X 2<br>Giữa: D E C 3<br>Trỏ: F G R T V B 4 5</div>
                    <div class="hand-card"><b>Tay Phải:</b><br>Trỏ: H J Y U N M 6 7<br>Giữa: K I , 8<br>Áp út: L O . 9<br>Ngón út: ; P Enter 0</div>
                </div>
            </div>

            <div id="tab-3" class="tab-content hidden">
                <h2>Bảng xếp hạng Top 100</h2>
                <table id="leaderboard">
                    <thead><tr><th>Hạng</th><th>Tên</th><th>WPM</th><th>Ngày</th></tr></thead>
                    <tbody></tbody>
                </table>
            </div>

            <div id="tab-4" class="tab-content hidden">
                <h2>Chia sẻ văn bản</h2>
                <textarea id="share-input" placeholder="Nhập văn bản của bạn..."></textarea>
                <button class="btn btn-green" onclick="handleShare()" style="margin-top:10px">Đăng công khai</button>
                <div id="shared-container" style="margin-top:20px"></div>
            </div>

            <div id="tab-5" class="tab-content hidden">
                <div style="display:flex; justify-content:space-between">
                    <h2>Văn bản tùy chỉnh</h2>
                    <button class="btn" onclick="openCustomSettings()">Cài đặt từ |</button>
                </div>
                <div id="custom-display" class="word-box"></div>
                <input type="text" id="custom-typing-input" placeholder="Bắt đầu gõ từ tùy chỉnh...">
            </div>

            <div id="tab-profile" class="tab-content hidden">
                <h2>Hồ sơ cá nhân</h2>
                <div class="hand-card">
                    <p><strong>Tài khoản:</strong> <span id="prof-user">***</span></p>
                    <p><strong>Gmail:</strong> <span id="prof-mail">***</span></p>
                    <p><strong>Ngày gia nhập:</strong> <span id="prof-date"></span></p>
                    <hr>
                    <h4>Đổi mật khẩu</h4>
                    <input type="password" id="new-pass" placeholder="Mật khẩu mới">
                    <button class="btn" style="margin-top:10px" onclick="updatePass()">Cập nhật</button>
                </div>
            </div>
        </div>
    </div>

    <div id="auth-modal" class="modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); z-index:99; justify-content:center; align-items:center;">
        <div class="modal-content" style="background:white; padding:25px; border-radius:8px; width:320px;">
            <div class="auth-tabs">
                <div class="auth-tab active" id="tab-login-btn" onclick="toggleAuthMode('login')">Đăng nhập</div>
                <div class="auth-tab" id="tab-reg-btn" onclick="toggleAuthMode('reg')">Đăng ký</div>
            </div>
            <input type="text" id="auth-u" placeholder="Tên tài khoản" style="margin-bottom:10px">
            <div id="reg-fields" class="hidden">
                <input type="email" id="auth-e" placeholder="Gmail" style="margin-bottom:10px">
            </div>
            <input type="password" id="auth-p" placeholder="Mật khẩu" style="margin-bottom:15px">
            <button class="btn" style="width:100%" onclick="submitAuth()">Xác nhận</button>
            <center><p onclick="document.getElementById('auth-modal').style.display='none'" style="cursor:pointer; color:#777; margin-top:10px">Đóng</p></center>
        </div>
    </div>

    <div id="custom-modal" class="modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); z-index:99; justify-content:center; align-items:center;">
        <div class="modal-content" style="background:white; padding:25px; border-radius:8px; width:400px;">
            <h3>Cấu hình từ vựng</h3>
            <textarea id="custom-raw" style="height:150px">tôi|đi|học|mỗi|ngày</textarea>
            <button class="btn" style="margin-top:10px; width:100%" onclick="saveCustomDict()">Lưu lại</button>
        </div>
    </div>

    <script>
        // ADMIN & DATA
        const ADMIN_USER = "nhtseri";
        const ADMIN_PASS = "Locthinh52!";
        const DEFAULT_WORDS = "chào|học|sinh|trường|chuyên|nghiệp|lập|trình|viên|công|nghệ|thông|tin|việt|nam|thành|công|nỗ|lực".split('|');
        
        let currentUser = JSON.parse(localStorage.getItem('user')) || null;
        let authMode = 'login';
        let currentDict = [...DEFAULT_WORDS];
        let activeWords = [];
        let curIdx = 0;
        let timeLeft = 30;
        let timer = null;
        let corrects = 0;

        // AUTH SYSTEM
        function toggleAuthMode(m) {
            authMode = m;
            document.getElementById('tab-login-btn').classList.toggle('active', m==='login');
            document.getElementById('tab-reg-btn').classList.toggle('active', m==='reg');
            document.getElementById('reg-fields').classList.toggle('hidden', m==='login');
        }

        function submitAuth() {
            const u = document.getElementById('auth-u').value;
            const p = document.getElementById('auth-p').value;
            const e = document.getElementById('auth-e').value;

            if(u === ADMIN_USER && p === ADMIN_PASS) {
                loginSuccess({username: u, email: "admin@system.com", date: "01/01/2026", pass: p});
                return;
            }

            if(authMode === 'login') {
                const saved = JSON.parse(localStorage.getItem('acc_' + u));
                if(saved && saved.pass === p) loginSuccess(saved);
                else alert("Sai tài khoản hoặc mật khẩu!");
            } else {
                const acc = {username: u, email: e, pass: p, date: new Date().toLocaleDateString()};
                localStorage.setItem('acc_' + u, JSON.stringify(acc));
                alert("Đăng ký xong! Hãy đăng nhập.");
                toggleAuthMode('login');
            }
        }

        function loginSuccess(user) {
            currentUser = user;
            localStorage.setItem('user', JSON.stringify(user));
            location.reload();
        }

        function logout() {
            localStorage.removeItem('user');
            location.reload();
        }

        // TAB SYSTEM
        function switchTab(id) {
            if(!currentUser) return showModal('auth-modal');
            document.querySelectorAll('.tab-content').forEach(t => t.classList.add('hidden'));
            document.querySelectorAll('.menu-item').forEach(m => m.classList.remove('active'));
            document.getElementById(id).classList.remove('hidden');
            document.getElementById('m' + id.split('-')[1] || 'mp').classList.add('active');
            
            resetTyping(id === 'tab-1');
            if(id === 'tab-3') updateLeaderboard();
            if(id === 'tab-4') renderShares();
            if(id === 'tab-5') initCustom();
            if(id === 'tab-profile') loadProfile();
        }

        // TYPING ENGINE
        function initTyping(isDefault = true, customList = null) {
            const dict = customList || DEFAULT_WORDS;
            activeWords = Array.from({length: 100}, () => dict[Math.floor(Math.random() * dict.length)]);
            curIdx = 0; corrects = 0;
            renderWords('word-display', activeWords);
        }

        function renderWords(divId, list) {
            const box = document.getElementById(divId);
            box.innerHTML = list.map((w, i) => `<span class="word" id="${divId}-${i}">${w}</span>`).join('');
            document.getElementById(`${divId}-0`).classList.add('current');
        }

        function resetTyping(isDefault) {
            clearInterval(timer); timer = null;
            timeLeft = 30;
            document.getElementById('timer').innerText = "30";
            document.getElementById('typing-input').value = "";
            document.getElementById('typing-title').innerText = isDefault ? "Tập đánh máy (Top 200 từ)" : "Đang gõ văn bản chia sẻ";
            initTyping(isDefault, isDefault ? null : currentDict);
        }

        document.getElementById('typing-input').addEventListener('input', function() {
            if(!timer) {
                timer = setInterval(() => {
                    timeLeft--;
                    document.getElementById('timer').innerText = timeLeft;
                    if(timeLeft <= 0) {
                        clearInterval(timer);
                        const wpm = Math.round((corrects/5)/0.5);
                        saveScore(wpm);
                        alert("Kết quả: " + wpm + " WPM");
                        resetTyping(true);
                    }
                }, 1000);
            }
            if(this.value.endsWith(' ')) {
                const typed = this.value.trim();
                const el = document.getElementById(`word-display-${curIdx}`);
                if(typed === activeWords[curIdx]) {
                    el.classList.add('correct');
                    corrects += typed.length + 1;
                } else el.classList.add('incorrect');
                el.classList.remove('current');
                curIdx++;
                document.getElementById(`word-display-${curIdx}`).classList.add('current');
                this.value = '';
            }
        });

        // SHARING SYSTEM
        function handleShare() {
            const txt = document.getElementById('share-input').value;
            if(!txt) return;
            const shares = JSON.parse(localStorage.getItem('shares') || "[]");
            shares.unshift({u: currentUser.username, content: txt});
            localStorage.setItem('shares', JSON.stringify(shares));
            document.getElementById('share-input').value = "";
            renderShares();
        }

        function renderShares() {
            const shares = JSON.parse(localStorage.getItem('shares') || "[]");
            document.getElementById('shared-container').innerHTML = shares.map((s, i) => `
                <div class="hand-card" style="margin-bottom:10px">
                    <b>${s.u}</b>: ${s.content.substring(0,30)}... 
                    <button class="btn" onclick="startShared(${i})">Gõ chung</button>
                </div>
            `).join('');
        }

        function startShared(i) {
            const shares = JSON.parse(localStorage.getItem('shares') || "[]");
            currentDict = shares[i].content.split(' ');
            switchTab('tab-1');
            resetTyping(false);
        }

        // PROFILE & OTHER
        function loadProfile() {
            document.getElementById('prof-user').innerText = currentUser.username.charAt(0) + "****" + currentUser.username.slice(-1);
            document.getElementById('prof-mail').innerText = currentUser.email.split('@')[0].substring(0,3) + "****@gmail.com";
            document.getElementById('prof-date').innerText = currentUser.date;
        }

        function updatePass() {
            const np = document.getElementById('new-pass').value;
            if(!np) return;
            currentUser.pass = np;
            localStorage.setItem('acc_' + currentUser.username, JSON.stringify(currentUser));
            localStorage.setItem('user', JSON.stringify(currentUser));
            alert("Đã đổi mật khẩu!");
        }

        function saveScore(wpm) {
            const leader = JSON.parse(localStorage.getItem('top100') || "[]");
            leader.push({u: currentUser.username, wpm: wpm, d: new Date().toLocaleDateString()});
            leader.sort((a,b) => b.wpm - a.wpm);
            localStorage.setItem('top100', JSON.stringify(leader.slice(0, 100)));
        }

        function updateLeaderboard() {
            const leader = JSON.parse(localStorage.getItem('top100') || "[]");
            document.querySelector('#leaderboard tbody').innerHTML = leader.map((s, i) => `
                <tr><td>${i+1}</td><td>${s.u}</td><td>${s.wpm}</td><td>${s.d}</td></tr>
            `).join('');
        }

        function showModal(id) { document.getElementById(id).style.display = 'flex'; }
        function initCustom() {
            const d = (localStorage.getItem('cust_dict') || "tôi|yêu|lập|trình").split('|');
            renderWords('custom-display', Array.from({length:30}, () => d[Math.floor(Math.random()*d.length)]));
        }
        function openCustomSettings() { showModal('custom-modal'); }
        function saveCustomDict() {
            localStorage.setItem('cust_dict', document.getElementById('custom-raw').value);
            document.getElementById('custom-modal').style.display='none';
            initCustom();
        }

        window.onload = () => {
            if(currentUser) {
                document.getElementById('guest-sidebar').classList.add('hidden');
                document.getElementById('user-sidebar').classList.remove('hidden');
                document.getElementById('profile-sidebar').classList.remove('hidden');
                initTyping();
            } else {
                showModal('auth-modal');
            }
        };
    </script>
</body>
</html>
