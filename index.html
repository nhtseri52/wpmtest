<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Typing Master Pro - Admin Elite</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --primary: #3498db; --bg: #cfe2f3; --dark: #44475a; --success: #2ecc71; --danger: #e74c3c; --white: #ffffff; }
        * { box-sizing: border-box; font-family: 'Segoe UI', sans-serif; transition: 0.3s; }
        body { background: var(--bg); display: flex; padding: 25px; gap: 20px; margin: 0; height: 100vh; color: #333; }
        
        /* Sidebar */
        .sidebar { width: 320px; flex-shrink: 0; display: flex; flex-direction: column; gap: 15px; }
        .side-card { background: var(--white); border-radius: 15px; box-shadow: 0 8px 20px rgba(0,0,0,0.1); overflow: hidden; }
        .nav-item { padding: 15px 20px; cursor: pointer; display: flex; align-items: center; gap: 12px; border-bottom: 1px solid #f0f0f0; font-weight: 500; }
        .nav-item.active { background: var(--primary); color: white; }
        .nav-item:hover:not(.active) { background: #f8f9fa; transform: translateX(5px); }

        /* Main Content */
        .content-panel { background: var(--white); padding: 35px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); flex-grow: 1; overflow-y: auto; }
        .word-display { font-size: 28px; padding: 25px; background: #fdfdfd; border: 1px solid #e1e4e8; border-radius: 12px; min-height: 140px; margin-bottom: 25px; line-height: 1.8; color: #aaa; }
        .word-active { background: #d1d8e0; color: #2f3640; border-radius: 5px; padding: 0 8px; }
        .word-correct { color: var(--success); }
        .word-wrong { background: var(--danger); color: white; border-radius: 5px; padding: 0 5px; }

        .typing-bar { background: #b8d4f0; padding: 12px 20px; border-radius: 12px; display: flex; gap: 10px; }
        .input-style { flex: 1; height: 55px; padding: 0 20px; font-size: 22px; border-radius: 10px; border: 1px solid #999; outline: none; }
        .timer-badge { background: #3c4a5c; color: white; padding: 0 25px; height: 55px; display: flex; align-items: center; justify-content: center; font-size: 26px; border-radius: 10px; font-weight: bold; min-width: 100px; }
        .reset-btn { background: var(--primary); color: white; width: 60px; height: 55px; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 24px; cursor: pointer; border: none; }

        .modal { position: fixed; inset: 0; background: rgba(0,0,0,0.8); z-index: 10000; display: none; align-items: center; justify-content: center; backdrop-filter: blur(5px); }
        .modal-box { background: white; padding: 40px; border-radius: 20px; width: 450px; text-align: center; }
        
        .page { display: none; } .page.active { display: block; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { padding: 12px; border-bottom: 1px solid #eee; text-align: left; }
        .btn { padding: 10px 20px; border-radius: 8px; border: none; cursor: pointer; font-weight: bold; margin: 5px; }
        .btn-blue { background: var(--primary); color: white; }
        .btn-red { background: var(--danger); color: white; }
    </style>
</head>
<body>

    <div id="auth-screen" class="modal" style="display: flex;">
        <div class="modal-box">
            <h2 style="margin-bottom:20px;">ƒêƒÉng nh·∫≠p h·ªá th·ªëng</h2>
            <input type="text" id="auth-u" placeholder="T√™n ƒëƒÉng nh·∫≠p" style="width:100%; padding:15px; margin-bottom:10px; border-radius:10px; border:1px solid #ddd;">
            <input type="password" id="auth-p" placeholder="M·∫≠t kh·∫©u" style="width:100%; padding:15px; margin-bottom:20px; border-radius:10px; border:1px solid #ddd;">
            <button class="btn btn-blue" style="width:100%; padding:15px;" onclick="app.handleAuth()">TRUY C·∫¨P</button>
        </div>
    </div>

    <div id="res-modal" class="modal">
        <div class="modal-box">
            <h1 style="color:var(--primary)">K·∫æT QU·∫¢</h1>
            <div style="display:flex; justify-content:space-around; margin:30px 0;">
                <div><h2 id="r-wpm">0</h2><small>WPM</small></div>
                <div><h2 id="r-acc">0%</h2><small>Ch√≠nh x√°c</small></div>
            </div>
            <button class="btn btn-blue" onclick="app.closeRes()">TH·ª¨ L·∫†I</button>
        </div>
    </div>

    <div class="sidebar" id="sidebar-inject"></div>

    <div class="content-panel">
        <div id="page-1" class="page active">
            <h1 id="t-m1">M·ª•c 1</h1>
            <div id="display-1" class="word-display"></div>
            <div class="typing-bar">
                <input type="text" id="input-1" class="input-style" placeholder="B·∫Øt ƒë·∫ßu g√µ..." autocomplete="off">
                <div id="timer-1" class="timer-badge">1:00</div>
                <button class="reset-btn" onclick="app.resetTyping()"><i class="fa-solid fa-rotate-right"></i></button>
            </div>
        </div>

        <div id="page-profile" class="page">
            <h1>H·ªì s∆° c·ªßa t√¥i</h1>
            <div style="background:#f8f9fa; padding:25px; border-radius:15px; max-width:500px;">
                <p>Username: <b id="p-user"></b></p>
                <p>Email: <b id="p-email"></b></p>
                <p>K·ª∑ l·ª•c WPM: <b id="p-best">0</b></p>
                <hr>
                <h3>ƒê·ªïi m·∫≠t kh·∫©u</h3>
                <input type="password" id="new-pass" placeholder="M·∫≠t kh·∫©u m·ªõi" style="width:100%; padding:10px; margin-bottom:10px;">
                <button class="btn btn-blue" onclick="app.changePass()">C·∫≠p nh·∫≠t</button>
            </div>
        </div>

        <div id="page-2" class="page">
            <h1 id="t-m2">M·ª•c 2</h1>
            <img id="img-m2" src="" style="width:100%; border-radius:15px;">
            <p id="desc-m2">N·ªôi dung h∆∞·ªõng d·∫´n...</p>
        </div>

        <div id="page-3" class="page">
            <h1 id="t-m3">B·∫£ng x·∫øp h·∫°ng</h1>
            <table><thead><tr><th>H·∫°ng</th><th>T√™n</th><th>WPM</th><th>ƒê·ªô ch√≠nh x√°c</th></tr></thead><tbody id="rank-data"></tbody></table>
        </div>

        <div id="page-4" class="page">
            <h1 id="t-m4">C·ªông ƒë·ªìng</h1>
            <div style="display:flex; gap:10px; margin-bottom:20px;">
                <input type="text" id="q-comm" placeholder="T√¨m ki·∫øm vƒÉn b·∫£n..." oninput="app.renderComm()" style="flex:1; padding:12px; border-radius:10px;">
                <button class="btn btn-blue" onclick="app.sortComm('like')">Top Like</button>
                <button class="btn btn-blue" onclick="app.addPost()">+ ƒêƒÉng b√†i</button>
            </div>
            <table><thead><tr><th>T·ª±a ƒë·ªÅ</th><th>Ng∆∞·ªùi ƒëƒÉng</th><th>Like</th><th>Thao t√°c</th></tr></thead><tbody id="comm-data"></tbody></table>
        </div>

        <div id="page-god" class="page">
            <h1 style="color:var(--danger)">GOD MODE CONTROL</h1>
            <div style="background:#fff3cd; padding:20px; border-radius:15px;">
                <h3>Qu·∫£n l√Ω M·ª•c</h3>
                Ch·ªçn: <select id="sel-m" onchange="app.loadAdminSet()"><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option></select>
                T√™n: <input type="text" id="set-t">
                ·∫¢nh: <input type="text" id="set-i">
                <button class="btn btn-blue" onclick="app.saveAdminSet()">L∆∞u</button>
            </div>
            <div style="background:#eee; padding:20px; border-radius:15px; margin-top:20px;">
                <h3>Ng∆∞·ªùi d√πng to√†n h·ªá th·ªëng</h3>
                <table><thead><tr><th>User</th><th>Pass</th><th>Email</th><th>X√≥a</th></tr></thead><tbody id="user-data"></tbody></table>
            </div>
        </div>
    </div>

    <script>
        const DATA = "anh|em|gia|ƒë√¨nh|tr∆∞·ªùng|h·ªçc|b√†n|ph√≠m|m√°y|t√≠nh|chu·ªôt|m√†n|h√¨nh|l·∫≠p|tr√¨nh|thi·∫øt|k·∫ø|√¢m|nh·∫°c|th√†nh|c√¥ng|h·∫°nh|ph√∫c|n·ªó|l·ª±c|ki√™n|tr√¨|vi·ªát|nam|h√†|n·ªôi|s√†i|g√≤n|du|l·ªãch|bi·ªÉn|r·ª´ng|n√∫i|s√¥ng|hoa|l√°|m·∫∑t|tr·ªùi|m∆∞a|n·∫Øng|gi√≥|kh√¥ng|kh√≠|n∆∞·ªõc|ƒÉn|ngon|vui|v·∫ª|t·ª±|tin|m·∫°nh|m·∫Ω|th√¥ng|minh|s√°ng|t·∫°o|t√†i|nƒÉng|l·ªãch|s·ª≠|to√°n|v·∫≠t|l√Ω|h√≥a|h·ªçc|ng·ªØ|vƒÉn|ti·∫øng|anh|nh·∫≠t|b·∫£n|h√†n|qu·ªëc|m·ªπ|ph√°p|ƒë·ªôc|l·∫≠p|t·ª±|do|b√¨nh|ƒë·∫≥ng|nh√¢n|d√¢n|t·ªï|qu·ªëc|√¥ng|b√†|cha|m·∫π|th·∫ßy|c√¥|b·∫°n|b√®|sinh|nh·∫≠t|l·ªÖ|h·ªôi|t·∫øt|xu√¢n|h·∫°|thu|ƒë√¥ng|s√°ch|v·ªü|vi·∫øt|m·ª±c|l·ªõp|h·ªçc|ƒëi·ªÉm|s·ªë|ki·∫øn|th·ª©c|k·ªπ|nƒÉng|vi·ªác|l√†m|c√¥ng|ty|vƒÉn|ph√≤ng|gi√°m|ƒë·ªëc|kh√°ch|h√†ng|d·ªãch|v·ª•|ch·∫•t|l∆∞·ª£ng|th·ªã|tr∆∞·ªùng|ƒë·∫ßu|t∆∞|t√†i|ch√≠nh|ng√¢n|h√†ng|ti·ªÅn|t·ªá|v√†ng|b·∫°c|trang|s·ª©c|qu·∫ßn|√°o|gi√†y|d√©p|m·ªπ|ph·∫©m|l√†m|ƒë·∫πp|s·ª©c|kh·ªèe|th·ªÉ|thao|b√≥ng|ƒë√°|gym|yoga|v√µ|thu·∫≠t|gi·∫£i|tr√≠|phim|·∫£nh|b√°o|ch√≠|m·∫°ng|x√£|h·ªôi|ƒëi·ªán|tho·∫°i|ch·ª•p|·∫£nh|ki·∫øn|tr√∫c|nh√†|·ªü|kh√°ch|s·∫°n|c√†|ph√™|tr√†|s·ªØa|ph·ªü|b√∫n|c∆°m|tr√°i|c√¢y|rau|c·ªß|th·ªãt|c√°|tr·ª©ng|s·ªØa|cam|qu√Ωt|chu·ªëi|t√°o|nho|xo√†i|d·ª´a|·ªïi|h·ªìng|bia|r∆∞·ª£u|k·∫πo|m·ª©t".split('|');

        const app = {
            user: null, words: [], curIdx: 0, timer: null, timeLeft: 60, ok: 0, err: 0, isPlaying: false,
            conf: JSON.parse(localStorage.getItem('conf_v15')) || { m1:"T·∫≠p g√µ", m2:"H∆∞·ªõng d·∫´n", m3:"X·∫øp h·∫°ng", m4:"C·ªông ƒë·ªìng", time:60, img2:"https://vcdn-vnexpress.vnecdn.net/2021/03/17/keyboard-1615969566-8835-1615969623.jpg" },

            init() {
                const s = localStorage.getItem('ss_v15');
                if(s) { 
                    this.user = JSON.parse(s);
                    document.getElementById('auth-screen').style.display = 'none';
                    this.applyConf(); this.showPage(1);
                }
            },

            handleAuth() {
                const u = document.getElementById('auth-u').value.trim(), p = document.getElementById('auth-p').value.trim();
                if(u === 'nhtseri' && p === 'Locthinh1!') {
                    this.user = {u, isAdmin: true, e:'admin@system.com', best:0};
                } else {
                    let d = JSON.parse(localStorage.getItem('usr_'+u));
                    if(d) {
                        if(d.p === p) this.user = {u, isAdmin:false, e:d.e, best:d.best||0};
                        else return alert("Sai m·∫≠t kh·∫©u!");
                    } else {
                        const newUser = {p, e:u+'@gmail.com', best:0};
                        localStorage.setItem('usr_'+u, JSON.stringify(newUser));
                        this.user = {u, isAdmin:false, e:newUser.e, best:0};
                    }
                }
                localStorage.setItem('ss_v15', JSON.stringify(this.user));
                location.reload();
            },

            applyConf() {
                document.getElementById('t-m1').innerText = this.conf.m1;
                document.getElementById('t-m2').innerText = this.conf.m2;
                document.getElementById('t-m3').innerText = this.conf.m3;
                document.getElementById('t-m4').innerText = this.conf.m4;
                document.getElementById('img-m2').src = this.conf.img2;
                this.renderSidebar();
            },

            renderSidebar() {
                let h = `<div class="side-card"><div style="padding:20px; text-align:center; background:#f0f0f0;"><b>üëã ${this.user.u}</b></div>`;
                h += `<div class="nav-item" id="nav-1" onclick="app.showPage(1)"><i class="fa-solid fa-keyboard"></i> ${this.conf.m1}</div>`;
                h += `<div class="nav-item" id="nav-2" onclick="app.showPage(2)"><i class="fa-solid fa-book"></i> ${this.conf.m2}</div>`;
                h += `<div class="nav-item" id="nav-3" onclick="app.showPage(3)"><i class="fa-solid fa-trophy"></i> ${this.conf.m3}</div>`;
                h += `<div class="nav-item" id="nav-4" onclick="app.showPage(4)"><i class="fa-solid fa-users"></i> ${this.conf.m4}</div>`;
                h += `<div class="nav-item" id="nav-profile" onclick="app.showPage('profile')"><i class="fa-solid fa-user"></i> H·ªì s∆°</div>`;
                if(this.user.isAdmin) h += `<div class="nav-item" id="nav-god" style="color:var(--danger)" onclick="app.showPage('god')"><i class="fa-solid fa-ghost"></i> GOD MODE</div>`;
                h += `<div class="nav-item" style="color:#999" onclick="app.logout()">ƒêƒÉng xu·∫•t</div></div>`;
                document.getElementById('sidebar-inject').innerHTML = h;
            },

            showPage(id) {
                document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
                document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
                document.getElementById('page-'+id).classList.add('active');
                if(document.getElementById('nav-'+id)) document.getElementById('nav-'+id).classList.add('active');
                if(id === 1) this.resetTyping();
                if(id === 4) this.renderComm();
                if(id === 'profile') this.renderProfile();
                if(id === 'god') this.renderAdmin();
            },

            resetTyping() {
                clearInterval(this.timer); this.timeLeft = this.conf.time; this.curIdx = 0; this.ok = 0; this.err = 0; this.isPlaying = false;
                document.getElementById('timer-1').innerText = "1:00";
                document.getElementById('input-1').value = ""; document.getElementById('input-1').disabled = false;
                this.words = Array.from({length:40}, () => DATA[Math.floor(Math.random()*DATA.length)]);
                document.getElementById('display-1').innerHTML = this.words.map((w,i) => `<span id="w-${i}" class="${i===0?'word-active':''}">${w}</span>`).join(" ");
            },

            handleInput(e) {
                if(!this.isPlaying) { this.isPlaying = true; this.timer = setInterval(() => {
                    this.timeLeft--;
                    let m = Math.floor(this.timeLeft / 60), s = this.timeLeft % 60;
                    document.getElementById('timer-1').innerText = `${m}:${s < 10 ? '0'+s : s}`;
                    if(this.timeLeft <= 0) this.finish();
                }, 1000); }
                if(e.target.value.endsWith(" ")) {
                    const typed = e.target.value.trim();
                    const el = document.getElementById('w-'+this.curIdx);
                    if(typed === this.words[this.curIdx]) { el.className = 'word-correct'; this.ok++; }
                    else { el.className = 'word-wrong'; this.err++; }
                    this.curIdx++;
                    if(this.curIdx < this.words.length) document.getElementById('w-'+this.curIdx).className = 'word-active';
                    else this.finish();
                    e.target.value = "";
                }
            },

            finish() {
                clearInterval(this.timer);
                const acc = Math.round((this.ok / (this.ok + this.err)) * 100) || 0;
                document.getElementById('r-wpm').innerText = this.ok;
                document.getElementById('r-acc').innerText = acc + "%";
                document.getElementById('res-modal').style.display = 'flex';
                document.getElementById('input-1').disabled = true;
                if(this.ok > (this.user.best || 0)) {
                    this.user.best = this.ok;
                    localStorage.setItem('ss_v15', JSON.stringify(this.user));
                    if(!this.user.isAdmin) {
                        let d = JSON.parse(localStorage.getItem('usr_'+this.user.u));
                        d.best = this.ok; localStorage.setItem('usr_'+this.user.u, JSON.stringify(d));
                    }
                }
                let ranks = JSON.parse(localStorage.getItem('ranks_v15') || "[]");
                ranks.push({u:this.user.u, wpm:this.ok, acc});
                ranks.sort((a,b) => b.wpm - a.wpm);
                localStorage.setItem('ranks_v15', JSON.stringify(ranks.slice(0,10)));
                this.renderRank();
            },

            renderRank() {
                const ranks = JSON.parse(localStorage.getItem('ranks_v15') || "[]");
                document.getElementById('rank-data').innerHTML = ranks.map((r,i) => `<tr><td>${i+1}</td><td>${r.u}</td><td>${r.wpm}</td><td>${r.acc}%</td></tr>`).join("");
            },

            renderProfile() {
                document.getElementById('p-user').innerText = this.user.u;
                document.getElementById('p-email').innerText = this.user.e;
                document.getElementById('p-best').innerText = this.user.best || 0;
            },

            changePass() {
                const np = document.getElementById('new-pass').value;
                if(np) {
                    if(this.user.isAdmin) alert("Admin kh√¥ng th·ªÉ ƒë·ªïi pass t·∫°i ƒë√¢y!");
                    else {
                        let d = JSON.parse(localStorage.getItem('usr_'+this.user.u));
                        d.p = np; localStorage.setItem('usr_'+this.user.u, JSON.stringify(d));
                        alert("ƒê√£ ƒë·ªïi pass!");
                    }
                }
            },

            renderComm() {
                let posts = JSON.parse(localStorage.getItem('posts_v15') || "[]");
                const q = document.getElementById('q-comm').value.toLowerCase();
                if(q) posts = posts.filter(p => p.t.toLowerCase().includes(q));
                document.getElementById('comm-data').innerHTML = posts.map((p,i) => `
                    <tr><td><b>${p.t}</b></td><td>${p.u}</td><td>‚ù§Ô∏è ${p.l}</td>
                    <td><button class="btn btn-blue" onclick="app.like(${i})">Like</button> 
                    ${(this.user.isAdmin || p.u === this.user.u) ? `<button class="btn btn-red" onclick="app.delPost(${i})">X√≥a</button>` : ''}</td></tr>`).join("");
            },

            addPost() {
                const t = prompt("T·ª±a ƒë·ªÅ:"), c = prompt("N·ªôi dung:");
                if(t && c) {
                    let ps = JSON.parse(localStorage.getItem('posts_v15') || "[]");
                    ps.unshift({t, c, u:this.user.u, l:0, d:Date.now()});
                    localStorage.setItem('posts_v15', JSON.stringify(ps)); this.renderComm();
                }
            },

            like(i) { let ps = JSON.parse(localStorage.getItem('posts_v15')); ps[i].l++; localStorage.setItem('posts_v15', JSON.stringify(ps)); this.renderComm(); },
            delPost(i) { let ps = JSON.parse(localStorage.getItem('posts_v15')); ps.splice(i,1); localStorage.setItem('posts_v15', JSON.stringify(ps)); this.renderComm(); },
            sortComm(type) {
                let ps = JSON.parse(localStorage.getItem('posts_v15') || "[]");
                ps.sort((a,b) => b.l - a.l); localStorage.setItem('posts_v15', JSON.stringify(ps)); this.renderComm();
            },

            renderAdmin() {
                let h = '';
                for(let i=0; i<localStorage.length; i++){
                    let k = localStorage.key(i);
                    if(k.startsWith('usr_')){
                        let d = JSON.parse(localStorage.getItem(k));
                        h += `<tr><td>${k.replace('usr_','')}</td><td>${d.p}</td><td>${d.e}</td><td><button onclick="app.delU('${k}')">X√≥a</button></td></tr>`;
                    }
                }
                document.getElementById('user-data').innerHTML = h;
            },

            loadAdminSet() { document.getElementById('set-t').value = this.conf['m'+document.getElementById('sel-m').value]; },
            saveAdminSet() {
                const m = document.getElementById('sel-m').value;
                this.conf['m'+m] = document.getElementById('set-t').value;
                if(m == '2' && document.getElementById('set-i').value) this.conf.img2 = document.getElementById('set-i').value;
                localStorage.setItem('conf_v15', JSON.stringify(this.conf)); location.reload();
            },

            delU(k) { if(confirm("X√≥a user?")) { localStorage.removeItem(k); this.renderAdmin(); } },
            closeRes() { document.getElementById('res-modal').style.display = 'none'; this.resetTyping(); },
            logout() { localStorage.removeItem('ss_v15'); location.reload(); }
        };

        document.getElementById('input-1').addEventListener('input', (e) => app.handleInput(e));
        window.onload = () => { app.init(); app.renderRank(); };
    </script>
</body>
</html>
